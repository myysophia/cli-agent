# Cursor Agent CI é›†æˆæŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬é¡¹ç›®é›†æˆäº† Cursor Agent CLI åˆ° GitHub Actionsï¼Œå¯ä»¥è‡ªåŠ¨è¿è¡Œ AI é©±åŠ¨çš„ä»£ç åˆ†æå’Œæµ‹è¯•ä»»åŠ¡ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GitHub Actions è§¦å‘                          â”‚
â”‚  â€¢ æ¯å¤©å®šæ—¶è¿è¡Œ (UTC 8:00)                                       â”‚
â”‚  â€¢ æ‰‹åŠ¨è§¦å‘ï¼ˆæ”¯æŒè‡ªå®šä¹‰æç¤ºï¼‰                                     â”‚
â”‚  â€¢ ä»£ç æ¨é€è§¦å‘                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç¯å¢ƒå‡†å¤‡                                       â”‚
â”‚  â€¢ å®‰è£… Python 3.11                                             â”‚
â”‚  â€¢ å®‰è£… uv (MCP æœåŠ¡å™¨è¿è¡Œæ—¶)                                   â”‚
â”‚  â€¢ å®‰è£… Cursor CLI                                              â”‚
â”‚  â€¢ é…ç½® MCP æœåŠ¡å™¨                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è¿è¡Œæµ‹è¯•                                       â”‚
â”‚  â€¢ Test 1: ä»£ç ç»“æ„åˆ†æ                                         â”‚
â”‚  â€¢ Test 2: Release Notes åŠŸèƒ½æ£€æŸ¥                               â”‚
â”‚  â€¢ Test 3: API ç«¯ç‚¹å®¡æŸ¥                                         â”‚
â”‚  â€¢ Test 4: MCP å·¥å…·æµ‹è¯• (fetch)                                 â”‚
â”‚  â€¢ Test 5: è‡ªå®šä¹‰æç¤ºï¼ˆå¯é€‰ï¼‰                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”ŸæˆæŠ¥å‘Š                                       â”‚
â”‚  â€¢ ç”Ÿæˆ Markdown æµ‹è¯•æŠ¥å‘Š                                       â”‚
â”‚  â€¢ ä¸Šä¼ ä¸º Artifact                                              â”‚
â”‚  â€¢ æ˜¾ç¤ºåœ¨ Actions Summary                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ é…ç½®æ­¥éª¤

### 1. è·å– Cursor API Key

1. ç™»å½• [Cursor Dashboard](https://cursor.com/dashboard)
2. è¿›å…¥ API è®¾ç½®
3. ç”Ÿæˆæ–°çš„ API Key
4. å¤åˆ¶ API Key

### 2. é…ç½® GitHub Secrets

```bash
# ä½¿ç”¨ GitHub CLI
gh secret set CURSOR_API_KEY --repo OWNER/REPO --body "your-api-key"

# æˆ–è€…é€šè¿‡ GitHub ç•Œé¢
# Settings > Secrets and variables > Actions > New repository secret
# Name: CURSOR_API_KEY
# Value: your-api-key
```

### 3. å¯ç”¨å·¥ä½œæµ

å·¥ä½œæµæ–‡ä»¶å·²åˆ›å»ºåœ¨ `.github/workflows/cursor-agent-test.yml`ï¼Œæ¨é€åè‡ªåŠ¨å¯ç”¨ã€‚

## ğŸ§ª æµ‹è¯•åœºæ™¯

### Test 1: ä»£ç ç»“æ„åˆ†æ
```
åˆ†æè¿™ä¸ª Go é¡¹ç›®çš„ç»“æ„ï¼Œåˆ—å‡ºä¸»è¦çš„åŒ…å’Œå®ƒä»¬çš„åŠŸèƒ½ã€‚
```
- ç›®çš„ï¼šéªŒè¯ Agent èƒ½æ­£ç¡®ç†è§£é¡¹ç›®ç»“æ„
- é¢„æœŸï¼šåˆ—å‡º cmd/, internal/, web/ ç­‰ç›®å½•åŠå…¶åŠŸèƒ½

### Test 2: Release Notes åŠŸèƒ½æ£€æŸ¥
```
æ£€æŸ¥ internal/release_notes ç›®å½•ä¸‹çš„ä»£ç ï¼Œå‘Šè¯‰æˆ‘æ”¯æŒå“ªäº› CLI å·¥å…·çš„ release notes è·å–ã€‚
```
- ç›®çš„ï¼šéªŒè¯ Agent èƒ½åˆ†æç‰¹å®šåŠŸèƒ½æ¨¡å—
- é¢„æœŸï¼šåˆ—å‡º Claude, Codex, Cursor, Gemini, Qwen

### Test 3: API ç«¯ç‚¹å®¡æŸ¥
```
æŸ¥çœ‹ internal/handler ç›®å½•ï¼Œåˆ—å‡ºæ‰€æœ‰ HTTP API ç«¯ç‚¹åŠå…¶åŠŸèƒ½ã€‚
```
- ç›®çš„ï¼šéªŒè¯ Agent èƒ½ç†è§£ API è®¾è®¡
- é¢„æœŸï¼šåˆ—å‡º /invoke, /chat, /release-notes ç­‰ç«¯ç‚¹

### Test 4: MCP å·¥å…·æµ‹è¯•
```
ä½¿ç”¨ fetch å·¥å…·è·å– GitHub APIï¼Œå‘Šè¯‰æˆ‘ Claude CLI çš„æœ€æ–°ç‰ˆæœ¬å·ã€‚
```
- ç›®çš„ï¼šéªŒè¯ MCP å·¥å…·é›†æˆæ­£å¸¸
- é¢„æœŸï¼šæˆåŠŸè°ƒç”¨ fetch å·¥å…·å¹¶è¿”å›ç‰ˆæœ¬ä¿¡æ¯

### Test 5: è‡ªå®šä¹‰æç¤º
- ç›®çš„ï¼šæ”¯æŒä¸´æ—¶æµ‹è¯•éœ€æ±‚
- ä½¿ç”¨ï¼šæ‰‹åŠ¨è§¦å‘å·¥ä½œæµæ—¶è¾“å…¥è‡ªå®šä¹‰æç¤º

## ğŸ” æƒé™é…ç½®

### åªè¯»æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

`.cursor-agent/permissions.json`:
```json
{
  "permissions": {
    "allow": [
      "Read(**/*)",
      "Shell(go)",
      "Shell(grep)",
      "Shell(find)"
    ],
    "deny": [
      "Write(**/*)",
      "Shell(git)",
      "Shell(gh)"
    ]
  }
}
```

### å®Œå…¨è‡ªä¸»æ¨¡å¼ï¼ˆé«˜çº§ï¼‰

å¦‚æœéœ€è¦ Agent èƒ½å¤Ÿä¿®æ”¹ä»£ç ï¼š
```json
{
  "permissions": {
    "allow": [
      "Read(**/*)",
      "Write(internal/**/*)",
      "Shell(go)",
      "Shell(git)"
    ],
    "deny": [
      "Write(.env*)",
      "Write(configs.json)"
    ]
  }
}
```

## ğŸ”§ MCP æœåŠ¡å™¨é…ç½®

### å½“å‰é…ç½®çš„ MCP æœåŠ¡å™¨

| æœåŠ¡å™¨ | åŠŸèƒ½ | ç”¨é€” |
|--------|------|------|
| filesystem | æ–‡ä»¶ç³»ç»Ÿè®¿é—® | è¯»å–é¡¹ç›®æ–‡ä»¶ |
| fetch | HTTP è¯·æ±‚ | è·å–å¤–éƒ¨ API æ•°æ® |

### æ·»åŠ æ›´å¤š MCP æœåŠ¡å™¨

ç¼–è¾‘ `.cursor/mcp.json`:
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "uvx",
      "args": ["mcp-server-filesystem", "--allowed-directories", "."]
    },
    "fetch": {
      "command": "uvx",
      "args": ["mcp-server-fetch"]
    },
    "github": {
      "command": "uvx",
      "args": ["mcp-server-github"],
      "env": {
        "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}"
      }
    }
  }
}
```

## ğŸ“Š æŸ¥çœ‹æµ‹è¯•ç»“æœ

### æ–¹å¼ 1: Actions Summary
1. è¿›å…¥ Actions æ ‡ç­¾
2. ç‚¹å‡»æœ€è¿‘çš„å·¥ä½œæµè¿è¡Œ
3. æŸ¥çœ‹ Summary éƒ¨åˆ†

### æ–¹å¼ 2: ä¸‹è½½ Artifact
1. è¿›å…¥å·¥ä½œæµè¿è¡Œè¯¦æƒ…
2. åœ¨ Artifacts éƒ¨åˆ†ä¸‹è½½ `cursor-agent-test-report`
3. è§£å‹æŸ¥çœ‹ `test_report.md`

### æ–¹å¼ 3: æŸ¥çœ‹æ—¥å¿—
1. è¿›å…¥å·¥ä½œæµè¿è¡Œè¯¦æƒ…
2. å±•å¼€å„ä¸ªæµ‹è¯•æ­¥éª¤
3. æŸ¥çœ‹è¯¦ç»†è¾“å‡º

## ğŸ”„ è§¦å‘æ–¹å¼

### è‡ªåŠ¨è§¦å‘
- **å®šæ—¶**: æ¯å¤© UTC 8:00ï¼ˆåŒ—äº¬æ—¶é—´ 16:00ï¼‰
- **ä»£ç æ¨é€**: å½“ `.github/workflows/cursor-agent-test.yml` æˆ– `.cursor-agent/**` æœ‰æ›´æ–°æ—¶

### æ‰‹åŠ¨è§¦å‘
1. è¿›å…¥ Actions æ ‡ç­¾
2. é€‰æ‹© "Cursor Agent Test"
3. ç‚¹å‡» "Run workflow"
4. å¯é€‰ï¼šè¾“å…¥è‡ªå®šä¹‰æµ‹è¯•æç¤º
5. ç‚¹å‡» "Run workflow"

## âš ï¸ æ³¨æ„äº‹é¡¹

### API é…é¢
- æ¯æ¬¡æµ‹è¯•è¿è¡Œä¼šæ¶ˆè€— Cursor API é…é¢
- å»ºè®®æ§åˆ¶æµ‹è¯•é¢‘ç‡
- å¯ä»¥è°ƒæ•´ `--max-turns` å‚æ•°é™åˆ¶å¯¹è¯è½®æ•°

### è¶…æ—¶è®¾ç½®
- å·¥ä½œæµè¶…æ—¶æ—¶é—´ï¼š30 åˆ†é’Ÿ
- å•ä¸ªæµ‹è¯•è¶…æ—¶ï¼šç”± `--max-turns` æ§åˆ¶

### å®‰å…¨è€ƒè™‘
- API Key å­˜å‚¨åœ¨ GitHub Secrets ä¸­
- é»˜è®¤ä½¿ç”¨åªè¯»æƒé™é…ç½®
- æ•æ„Ÿæ–‡ä»¶è¢«æ’é™¤åœ¨å†™å…¥æƒé™ä¹‹å¤–

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1: Cursor CLI å®‰è£…å¤±è´¥
```
é”™è¯¯: curl https://cursor.com/install failed
```
**è§£å†³**: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–ä½¿ç”¨å¤‡ç”¨å®‰è£…æ–¹å¼

### é—®é¢˜ 2: MCP æœåŠ¡å™¨å¯åŠ¨å¤±è´¥
```
é”™è¯¯: uvx command not found
```
**è§£å†³**: ç¡®ä¿ uv å®‰è£…æ­¥éª¤æ­£ç¡®æ‰§è¡Œ

### é—®é¢˜ 3: API Key æ— æ•ˆ
```
é”™è¯¯: Authentication failed
```
**è§£å†³**: 
1. æ£€æŸ¥ CURSOR_API_KEY secret æ˜¯å¦æ­£ç¡®è®¾ç½®
2. ç¡®è®¤ API Key æœªè¿‡æœŸ
3. æ£€æŸ¥ API é…é¢æ˜¯å¦ç”¨å°½

### é—®é¢˜ 4: æµ‹è¯•è¶…æ—¶
```
é”™è¯¯: Process timed out
```
**è§£å†³**: 
1. å‡å°‘ `--max-turns` å‚æ•°
2. ç®€åŒ–æµ‹è¯•æç¤º
3. å¢åŠ å·¥ä½œæµè¶…æ—¶æ—¶é—´

## ğŸ“š ç›¸å…³èµ„æº

- [Cursor CLI æ–‡æ¡£](https://cursor.com/docs/cli)
- [Cursor GitHub Actions æŒ‡å—](https://cursor.com/docs/cli/github-actions)
- [MCP åè®®æ–‡æ¡£](https://cursor.com/docs/context/mcp)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)

## ğŸ¯ æœ€ä½³å®è·µ

1. **é™åˆ¶æƒé™**: å§‹ç»ˆä½¿ç”¨æœ€å°æƒé™åŸåˆ™
2. **æ§åˆ¶æˆæœ¬**: åˆç†è®¾ç½®æµ‹è¯•é¢‘ç‡å’Œå¯¹è¯è½®æ•°
3. **ç›‘æ§ç»“æœ**: å®šæœŸæŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
4. **è¿­ä»£ä¼˜åŒ–**: æ ¹æ®æµ‹è¯•ç»“æœè°ƒæ•´æç¤ºå’Œé…ç½®
